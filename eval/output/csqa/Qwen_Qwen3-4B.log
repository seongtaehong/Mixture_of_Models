INFO 06-20 15:19:25 [importing.py:53] Triton module has been replaced with a placeholder.
INFO 06-20 15:19:25 [__init__.py:239] Automatically detected platform cuda.
2025-06-20:15:19:31 INFO     [__main__:440] Selected Tasks: ['commonsense_qa']
2025-06-20:15:19:31 INFO     [evaluator:185] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-06-20:15:19:31 INFO     [evaluator:223] Initializing vllm model, with arguments: {'pretrained': 'Qwen/Qwen3-4B', 'tensor_parallel_size': 1, 'dtype': 'auto', 'gpu_memory_utilization': 0.8}
INFO 06-20 15:19:40 [config.py:717] This model supports multiple tasks: {'score', 'classify', 'embed', 'reward', 'generate'}. Defaulting to 'generate'.
INFO 06-20 15:19:41 [config.py:2003] Chunked prefill is enabled with max_num_batched_tokens=8192.
INFO 06-20 15:19:50 [importing.py:53] Triton module has been replaced with a placeholder.
INFO 06-20 15:19:50 [__init__.py:239] Automatically detected platform cuda.
INFO 06-20 15:19:52 [core.py:58] Initializing a V1 LLM engine (v0.8.5.post1) with config: model='Qwen/Qwen3-4B', speculative_config=None, tokenizer='Qwen/Qwen3-4B', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=40960, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='auto', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=1234, served_model_name=Qwen/Qwen3-4B, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"level":3,"custom_ops":["none"],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"use_inductor":true,"compile_sizes":[],"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":512}
2025-06-20 15:19:53,047 - INFO - flashinfer.jit: Prebuilt kernels not found, using JIT backend
WARNING 06-20 15:19:53 [utils.py:2522] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f701d4f6510>
INFO 06-20 15:19:55 [parallel_state.py:1004] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
INFO 06-20 15:19:55 [cuda.py:221] Using Flash Attention backend on V1 engine.
INFO 06-20 15:19:55 [topk_topp_sampler.py:44] Currently, FlashInfer top-p & top-k sampling sampler is disabled because FlashInfer>=v0.2.3 is not backward compatible. Falling back to the PyTorch-native implementation of top-p & top-k sampling.
INFO 06-20 15:19:56 [gpu_model_runner.py:1329] Starting to load model Qwen/Qwen3-4B...
INFO 06-20 15:19:59 [weight_utils.py:265] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:   0% Completed | 0/3 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  33% Completed | 1/3 [00:01<00:02,  1.00s/it]
Loading safetensors checkpoint shards:  67% Completed | 2/3 [00:02<00:01,  1.05s/it]
Loading safetensors checkpoint shards: 100% Completed | 3/3 [00:02<00:00,  1.62it/s]
Loading safetensors checkpoint shards: 100% Completed | 3/3 [00:02<00:00,  1.37it/s]

INFO 06-20 15:20:02 [loader.py:458] Loading weights took 2.20 seconds
INFO 06-20 15:20:02 [gpu_model_runner.py:1347] Model loading took 7.5552 GiB and 6.139116 seconds
INFO 06-20 15:20:13 [backends.py:420] Using cache directory: /mnt/raid6/hst/.cache/vllm/torch_compile_cache/947a79113e/rank_0_0 for vLLM's torch.compile
INFO 06-20 15:20:13 [backends.py:430] Dynamo bytecode transform time: 10.66 s
INFO 06-20 15:20:57 [backends.py:118] Directly load the compiled graph(s) for shape None from the cache, took 43.526 s
INFO 06-20 15:21:00 [monitor.py:33] torch.compile takes 10.66 s in total
INFO 06-20 15:21:04 [kv_cache_utils.py:634] GPU KV cache size: 209,072 tokens
INFO 06-20 15:21:04 [kv_cache_utils.py:637] Maximum concurrency for 40,960 tokens per request: 5.10x
INFO 06-20 15:22:48 [gpu_model_runner.py:1686] Graph capturing finished in 104 secs, took 2.11 GiB
INFO 06-20 15:22:48 [core.py:159] init engine (profile, create kv cache, warmup model) took 165.72 seconds
INFO 06-20 15:22:48 [core_client.py:439] Core engine process 0 ready.
2025-06-20:15:22:59 INFO     [api.task:434] Building contexts for commonsense_qa on rank 0...
  0%|          | 0/1221 [00:00<?, ?it/s]  5%|▌         | 66/1221 [00:00<00:01, 658.93it/s] 11%|█         | 136/1221 [00:00<00:01, 680.52it/s] 17%|█▋        | 207/1221 [00:00<00:01, 692.30it/s] 23%|██▎       | 277/1221 [00:00<00:01, 690.10it/s] 29%|██▊       | 348/1221 [00:00<00:01, 694.07it/s] 34%|███▍      | 418/1221 [00:00<00:01, 695.12it/s] 40%|████      | 489/1221 [00:00<00:01, 699.62it/s] 46%|████▌     | 561/1221 [00:00<00:00, 703.12it/s] 52%|█████▏    | 633/1221 [00:00<00:00, 705.72it/s] 58%|█████▊    | 705/1221 [00:01<00:00, 707.04it/s] 64%|██████▎   | 777/1221 [00:01<00:00, 709.00it/s] 69%|██████▉   | 848/1221 [00:01<00:00, 701.17it/s] 75%|███████▌  | 919/1221 [00:01<00:00, 703.75it/s] 81%|████████  | 991/1221 [00:01<00:00, 705.94it/s] 87%|████████▋ | 1063/1221 [00:01<00:00, 707.30it/s] 93%|█████████▎| 1135/1221 [00:01<00:00, 709.60it/s] 99%|█████████▉| 1207/1221 [00:01<00:00, 711.15it/s]100%|██████████| 1221/1221 [00:01<00:00, 702.71it/s]
2025-06-20:15:23:00 INFO     [evaluator_utils:206] Task: ConfigurableTask(task_name=commonsense_qa,output_type=multiple_choice,num_fewshot=0,num_samples=1221); document 0; context prompt (starting on next line):    
Question: A revolving door is convenient for two direction travel, but it also serves as a security measure at a what?
A. bank
B. library
C. department store
D. mall
E. new york
Answer:
(end of prompt on previous line)
target string or answer choice index (starting on next line):
A
(end of target on previous line)
2025-06-20:15:23:00 INFO     [evaluator_utils:210] Request: Instance(request_type='loglikelihood', doc={'id': '1afa02df02c908a558b4036e80242fac', 'question': 'A revolving door is convenient for two direction travel, but it also serves as a security measure at a what?', 'question_concept': 'revolving door', 'choices': {'label': ['A', 'B', 'C', 'D', 'E'], 'text': ['bank', 'library', 'department store', 'mall', 'new york']}, 'answerKey': 'A'}, arguments=('Question: A revolving door is convenient for two direction travel, but it also serves as a security measure at a what?\nA. bank\nB. library\nC. department store\nD. mall\nE. new york\nAnswer:', ' A'), idx=0, metadata=('commonsense_qa', 0, 1), resps=[], filtered_resps={}, task_name='commonsense_qa', doc_id=0, repeats=1)
2025-06-20:15:23:00 INFO     [evaluator_utils:206] Task: ConfigurableTask(task_name=commonsense_qa,output_type=multiple_choice,num_fewshot=0,num_samples=1221); document 0; context prompt (starting on next line):    
Question: A revolving door is convenient for two direction travel, but it also serves as a security measure at a what?
A. bank
B. library
C. department store
D. mall
E. new york
Answer:
(end of prompt on previous line)
target string or answer choice index (starting on next line):
A
(end of target on previous line)
2025-06-20:15:23:00 INFO     [evaluator_utils:210] Request: Instance(request_type='loglikelihood', doc={'id': '1afa02df02c908a558b4036e80242fac', 'question': 'A revolving door is convenient for two direction travel, but it also serves as a security measure at a what?', 'question_concept': 'revolving door', 'choices': {'label': ['A', 'B', 'C', 'D', 'E'], 'text': ['bank', 'library', 'department store', 'mall', 'new york']}, 'answerKey': 'A'}, arguments=('Question: A revolving door is convenient for two direction travel, but it also serves as a security measure at a what?\nA. bank\nB. library\nC. department store\nD. mall\nE. new york\nAnswer:', ' B'), idx=1, metadata=('commonsense_qa', 0, 1), resps=[], filtered_resps={}, task_name='commonsense_qa', doc_id=0, repeats=1)
2025-06-20:15:23:00 INFO     [evaluator_utils:206] Task: ConfigurableTask(task_name=commonsense_qa,output_type=multiple_choice,num_fewshot=0,num_samples=1221); document 0; context prompt (starting on next line):    
Question: A revolving door is convenient for two direction travel, but it also serves as a security measure at a what?
A. bank
B. library
C. department store
D. mall
E. new york
Answer:
(end of prompt on previous line)
target string or answer choice index (starting on next line):
A
(end of target on previous line)
2025-06-20:15:23:00 INFO     [evaluator_utils:210] Request: Instance(request_type='loglikelihood', doc={'id': '1afa02df02c908a558b4036e80242fac', 'question': 'A revolving door is convenient for two direction travel, but it also serves as a security measure at a what?', 'question_concept': 'revolving door', 'choices': {'label': ['A', 'B', 'C', 'D', 'E'], 'text': ['bank', 'library', 'department store', 'mall', 'new york']}, 'answerKey': 'A'}, arguments=('Question: A revolving door is convenient for two direction travel, but it also serves as a security measure at a what?\nA. bank\nB. library\nC. department store\nD. mall\nE. new york\nAnswer:', ' C'), idx=2, metadata=('commonsense_qa', 0, 1), resps=[], filtered_resps={}, task_name='commonsense_qa', doc_id=0, repeats=1)
2025-06-20:15:23:00 INFO     [evaluator_utils:206] Task: ConfigurableTask(task_name=commonsense_qa,output_type=multiple_choice,num_fewshot=0,num_samples=1221); document 0; context prompt (starting on next line):    
Question: A revolving door is convenient for two direction travel, but it also serves as a security measure at a what?
A. bank
B. library
C. department store
D. mall
E. new york
Answer:
(end of prompt on previous line)
target string or answer choice index (starting on next line):
A
(end of target on previous line)
2025-06-20:15:23:00 INFO     [evaluator_utils:210] Request: Instance(request_type='loglikelihood', doc={'id': '1afa02df02c908a558b4036e80242fac', 'question': 'A revolving door is convenient for two direction travel, but it also serves as a security measure at a what?', 'question_concept': 'revolving door', 'choices': {'label': ['A', 'B', 'C', 'D', 'E'], 'text': ['bank', 'library', 'department store', 'mall', 'new york']}, 'answerKey': 'A'}, arguments=('Question: A revolving door is convenient for two direction travel, but it also serves as a security measure at a what?\nA. bank\nB. library\nC. department store\nD. mall\nE. new york\nAnswer:', ' D'), idx=3, metadata=('commonsense_qa', 0, 1), resps=[], filtered_resps={}, task_name='commonsense_qa', doc_id=0, repeats=1)
2025-06-20:15:23:00 INFO     [evaluator_utils:206] Task: ConfigurableTask(task_name=commonsense_qa,output_type=multiple_choice,num_fewshot=0,num_samples=1221); document 0; context prompt (starting on next line):    
Question: A revolving door is convenient for two direction travel, but it also serves as a security measure at a what?
A. bank
B. library
C. department store
D. mall
E. new york
Answer:
(end of prompt on previous line)
target string or answer choice index (starting on next line):
A
(end of target on previous line)
2025-06-20:15:23:00 INFO     [evaluator_utils:210] Request: Instance(request_type='loglikelihood', doc={'id': '1afa02df02c908a558b4036e80242fac', 'question': 'A revolving door is convenient for two direction travel, but it also serves as a security measure at a what?', 'question_concept': 'revolving door', 'choices': {'label': ['A', 'B', 'C', 'D', 'E'], 'text': ['bank', 'library', 'department store', 'mall', 'new york']}, 'answerKey': 'A'}, arguments=('Question: A revolving door is convenient for two direction travel, but it also serves as a security measure at a what?\nA. bank\nB. library\nC. department store\nD. mall\nE. new york\nAnswer:', ' E'), idx=4, metadata=('commonsense_qa', 0, 1), resps=[], filtered_resps={}, task_name='commonsense_qa', doc_id=0, repeats=1)
2025-06-20:15:23:00 INFO     [evaluator:559] Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/6105 [00:00<?, ?it/s]
Processed prompts:   0%|          | 0/6105 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   0%|          | 5/6105 [00:01<21:14,  4.79it/s, est. speed input: 435.65 toks/s, output: 4.79 toks/s][A
Processed prompts:   2%|▏         | 129/6105 [00:01<01:01, 97.85it/s, est. speed input: 5308.52 toks/s, output: 79.81 toks/s][A
Processed prompts:   4%|▍         | 270/6105 [00:02<00:45, 127.94it/s, est. speed input: 6699.54 toks/s, output: 107.83 toks/s][A
Processed prompts:   7%|▋         | 418/6105 [00:03<00:39, 142.80it/s, est. speed input: 7320.52 toks/s, output: 122.61 toks/s][A
Processed prompts:   9%|▉         | 572/6105 [00:04<00:36, 153.00it/s, est. speed input: 7687.91 toks/s, output: 132.57 toks/s][A
Processed prompts:  12%|█▏        | 730/6105 [00:05<00:33, 162.43it/s, est. speed input: 7968.67 toks/s, output: 140.68 toks/s][A
Processed prompts:  15%|█▍        | 892/6105 [00:06<00:31, 164.43it/s, est. speed input: 8048.98 toks/s, output: 144.99 toks/s][A
Processed prompts:  17%|█▋        | 1059/6105 [00:07<00:29, 169.59it/s, est. speed input: 8156.07 toks/s, output: 149.61 toks/s][A
Processed prompts:  20%|██        | 1229/6105 [00:08<00:28, 173.81it/s, est. speed input: 8229.84 toks/s, output: 153.48 toks/s][A
Processed prompts:  23%|██▎       | 1403/6105 [00:09<00:31, 147.37it/s, est. speed input: 7756.14 toks/s, output: 146.81 toks/s][A
Processed prompts:  26%|██▌       | 1577/6105 [00:09<00:23, 192.80it/s, est. speed input: 8342.35 toks/s, output: 159.85 toks/s][A
Processed prompts:  29%|██▊       | 1755/6105 [00:10<00:22, 192.34it/s, est. speed input: 8382.78 toks/s, output: 162.57 toks/s][A
Processed prompts:  32%|███▏      | 1935/6105 [00:11<00:21, 192.56it/s, est. speed input: 8416.75 toks/s, output: 164.99 toks/s][A
Processed prompts:  35%|███▍      | 2117/6105 [00:12<00:20, 193.37it/s, est. speed input: 8443.75 toks/s, output: 167.22 toks/s][A
Processed prompts:  38%|███▊      | 2301/6105 [00:13<00:19, 193.28it/s, est. speed input: 8453.49 toks/s, output: 169.03 toks/s][A
Processed prompts:  41%|████      | 2487/6105 [00:14<00:18, 194.73it/s, est. speed input: 8470.22 toks/s, output: 170.90 toks/s][A
Processed prompts:  44%|████▍     | 2674/6105 [00:15<00:17, 195.61it/s, est. speed input: 8482.08 toks/s, output: 172.53 toks/s][A
Processed prompts:  47%|████▋     | 2864/6105 [00:16<00:16, 197.19it/s, est. speed input: 8490.94 toks/s, output: 174.16 toks/s][A
Processed prompts:  50%|█████     | 3057/6105 [00:17<00:15, 198.17it/s, est. speed input: 8492.85 toks/s, output: 175.61 toks/s][A
Processed prompts:  53%|█████▎    | 3252/6105 [00:18<00:14, 199.45it/s, est. speed input: 8493.23 toks/s, output: 177.01 toks/s][A
Processed prompts:  57%|█████▋    | 3450/6105 [00:19<00:15, 167.08it/s, est. speed input: 8217.48 toks/s, output: 172.62 toks/s][A
Processed prompts:  60%|█████▉    | 3650/6105 [00:20<00:11, 216.09it/s, est. speed input: 8492.92 toks/s, output: 179.77 toks/s][A
Processed prompts:  63%|██████▎   | 3850/6105 [00:21<00:10, 211.03it/s, est. speed input: 8478.07 toks/s, output: 180.74 toks/s][A
Processed prompts:  66%|██████▋   | 4055/6105 [00:22<00:09, 210.07it/s, est. speed input: 8471.02 toks/s, output: 181.94 toks/s][A
Processed prompts:  70%|██████▉   | 4260/6105 [00:23<00:08, 210.15it/s, est. speed input: 8468.61 toks/s, output: 183.13 toks/s][A
Processed prompts:  73%|███████▎  | 4468/6105 [00:24<00:07, 212.61it/s, est. speed input: 8473.17 toks/s, output: 184.52 toks/s][A
Processed prompts:  77%|███████▋  | 4678/6105 [00:25<00:06, 208.30it/s, est. speed input: 8443.77 toks/s, output: 185.13 toks/s][A
Processed prompts:  80%|████████  | 4893/6105 [00:26<00:05, 210.58it/s, est. speed input: 8435.98 toks/s, output: 186.30 toks/s][A
Processed prompts:  84%|████████▎ | 5109/6105 [00:27<00:04, 212.52it/s, est. speed input: 8429.05 toks/s, output: 187.42 toks/s][A
Processed prompts:  87%|████████▋ | 5329/6105 [00:28<00:03, 215.06it/s, est. speed input: 8420.85 toks/s, output: 188.60 toks/s][A
Processed prompts:  91%|█████████ | 5553/6105 [00:29<00:02, 217.01it/s, est. speed input: 8410.36 toks/s, output: 189.73 toks/s][A
Processed prompts:  95%|█████████▍| 5782/6105 [00:30<00:01, 219.54it/s, est. speed input: 8398.64 toks/s, output: 190.93 toks/s][A
Processed prompts:  99%|█████████▊| 6019/6105 [00:30<00:00, 284.63it/s, est. speed input: 8584.21 toks/s, output: 196.82 toks/s][AProcessed prompts: 100%|██████████| 6105/6105 [00:30<00:00, 199.62it/s, est. speed input: 8673.94 toks/s, output: 199.62 toks/s]
Running loglikelihood requests:   0%|          | 1/6105 [00:31<52:34:04, 31.00s/it]Running loglikelihood requests:  89%|████████▉ | 5432/6105 [00:31<00:02, 249.13it/s]Running loglikelihood requests: 100%|██████████| 6105/6105 [00:31<00:00, 196.23it/s]
fatal: not a git repository (or any parent up to mount point /mnt)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
[rank0]:[W620 15:23:43.137028182 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
2025-06-20:15:23:44 INFO     [loggers.evaluation_tracker:209] Saving results aggregated
2025-06-20:15:23:44 INFO     [loggers.evaluation_tracker:298] Saving per-sample results for: commonsense_qa
vllm (pretrained=Qwen/Qwen3-4B,tensor_parallel_size=1,dtype=auto,gpu_memory_utilization=0.8), gen_kwargs: (None), limit: None, num_fewshot: None, batch_size: auto
|    Tasks     |Version|Filter|n-shot|Metric|   |Value |   |Stderr|
|--------------|-------|------|-----:|------|---|-----:|---|-----:|
|commonsense_qa|Yaml   |none  |     0|acc   |↑  |0.7568|±  |0.0123|

