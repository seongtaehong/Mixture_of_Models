INFO 05-22 19:44:09 [importing.py:53] Triton module has been replaced with a placeholder.
INFO 05-22 19:44:09 [__init__.py:239] Automatically detected platform cuda.
2025-05-22:19:44:12 INFO     [__main__:440] Selected Tasks: ['mathqa']
2025-05-22:19:44:12 INFO     [evaluator:185] Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
2025-05-22:19:44:12 INFO     [evaluator:223] Initializing hf model, with arguments: {'pretrained': 'meta-llama/Llama-3.2-1B-Instruct'}
2025-05-22:19:44:16 INFO     [models.huggingface:137] Using device 'cuda'
2025-05-22:19:44:17 INFO     [models.huggingface:382] Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
2025-05-22:19:44:25 INFO     [api.task:434] Building contexts for mathqa on rank 0...
  0%|          | 0/2985 [00:00<?, ?it/s]  9%|▉         | 280/2985 [00:00<00:00, 2793.14it/s] 19%|█▉        | 571/2985 [00:00<00:00, 2861.00it/s] 29%|██▉       | 862/2985 [00:00<00:00, 2881.44it/s] 39%|███▊      | 1151/2985 [00:00<00:00, 2873.58it/s] 48%|████▊     | 1439/2985 [00:00<00:00, 2873.83it/s] 58%|█████▊    | 1729/2985 [00:00<00:00, 2881.44it/s] 68%|██████▊   | 2018/2985 [00:00<00:00, 2855.45it/s] 77%|███████▋  | 2304/2985 [00:00<00:00, 2787.78it/s] 87%|████████▋ | 2594/2985 [00:00<00:00, 2819.33it/s] 97%|█████████▋| 2884/2985 [00:01<00:00, 2842.98it/s]100%|██████████| 2985/2985 [00:01<00:00, 2848.10it/s]
2025-05-22:19:44:27 INFO     [evaluator_utils:206] Task: ConfigurableTask(task_name=mathqa,output_type=multiple_choice,num_fewshot=0,num_samples=2985); document 0; context prompt (starting on next line):    
Question: a shopkeeper sold an article offering a discount of 5 % and earned a profit of 31.1 % . what would have been the percentage of profit earned if no discount had been offered ?
Answer:
(end of prompt on previous line)
target string or answer choice index (starting on next line):
0
(end of target on previous line)
2025-05-22:19:44:27 INFO     [evaluator_utils:210] Request: Instance(request_type='loglikelihood', doc={'Problem': 'a shopkeeper sold an article offering a discount of 5 % and earned a profit of 31.1 % . what would have been the percentage of profit earned if no discount had been offered ?', 'Rationale': '"giving no discount to customer implies selling the product on printed price . suppose the cost price of the article is 100 . then printed price = 100 ã — ( 100 + 31.1 ) / ( 100 â ˆ ’ 5 ) = 138 hence , required % profit = 138 â € “ 100 = 38 % answer a"', 'options': 'a ) 38 , b ) 27.675 , c ) 30 , d ) data inadequate , e ) none of these', 'correct': 'a', 'annotated_formula': 'subtract(divide(multiply(add(const_100, 31.1), const_100), subtract(const_100, 5)), const_100)', 'linear_formula': 'add(n1,const_100)|subtract(const_100,n0)|multiply(#0,const_100)|divide(#2,#1)|subtract(#3,const_100)|', 'category': 'gain'}, arguments=('Question: a shopkeeper sold an article offering a discount of 5 % and earned a profit of 31.1 % . what would have been the percentage of profit earned if no discount had been offered ?\nAnswer:', ' 38'), idx=0, metadata=('mathqa', 0, 1), resps=[], filtered_resps={}, task_name='mathqa', doc_id=0, repeats=1)
2025-05-22:19:44:27 INFO     [evaluator_utils:206] Task: ConfigurableTask(task_name=mathqa,output_type=multiple_choice,num_fewshot=0,num_samples=2985); document 0; context prompt (starting on next line):    
Question: a shopkeeper sold an article offering a discount of 5 % and earned a profit of 31.1 % . what would have been the percentage of profit earned if no discount had been offered ?
Answer:
(end of prompt on previous line)
target string or answer choice index (starting on next line):
0
(end of target on previous line)
2025-05-22:19:44:27 INFO     [evaluator_utils:210] Request: Instance(request_type='loglikelihood', doc={'Problem': 'a shopkeeper sold an article offering a discount of 5 % and earned a profit of 31.1 % . what would have been the percentage of profit earned if no discount had been offered ?', 'Rationale': '"giving no discount to customer implies selling the product on printed price . suppose the cost price of the article is 100 . then printed price = 100 ã — ( 100 + 31.1 ) / ( 100 â ˆ ’ 5 ) = 138 hence , required % profit = 138 â € “ 100 = 38 % answer a"', 'options': 'a ) 38 , b ) 27.675 , c ) 30 , d ) data inadequate , e ) none of these', 'correct': 'a', 'annotated_formula': 'subtract(divide(multiply(add(const_100, 31.1), const_100), subtract(const_100, 5)), const_100)', 'linear_formula': 'add(n1,const_100)|subtract(const_100,n0)|multiply(#0,const_100)|divide(#2,#1)|subtract(#3,const_100)|', 'category': 'gain'}, arguments=('Question: a shopkeeper sold an article offering a discount of 5 % and earned a profit of 31.1 % . what would have been the percentage of profit earned if no discount had been offered ?\nAnswer:', ' 27.675'), idx=1, metadata=('mathqa', 0, 1), resps=[], filtered_resps={}, task_name='mathqa', doc_id=0, repeats=1)
2025-05-22:19:44:27 INFO     [evaluator_utils:206] Task: ConfigurableTask(task_name=mathqa,output_type=multiple_choice,num_fewshot=0,num_samples=2985); document 0; context prompt (starting on next line):    
Question: a shopkeeper sold an article offering a discount of 5 % and earned a profit of 31.1 % . what would have been the percentage of profit earned if no discount had been offered ?
Answer:
(end of prompt on previous line)
target string or answer choice index (starting on next line):
0
(end of target on previous line)
2025-05-22:19:44:27 INFO     [evaluator_utils:210] Request: Instance(request_type='loglikelihood', doc={'Problem': 'a shopkeeper sold an article offering a discount of 5 % and earned a profit of 31.1 % . what would have been the percentage of profit earned if no discount had been offered ?', 'Rationale': '"giving no discount to customer implies selling the product on printed price . suppose the cost price of the article is 100 . then printed price = 100 ã — ( 100 + 31.1 ) / ( 100 â ˆ ’ 5 ) = 138 hence , required % profit = 138 â € “ 100 = 38 % answer a"', 'options': 'a ) 38 , b ) 27.675 , c ) 30 , d ) data inadequate , e ) none of these', 'correct': 'a', 'annotated_formula': 'subtract(divide(multiply(add(const_100, 31.1), const_100), subtract(const_100, 5)), const_100)', 'linear_formula': 'add(n1,const_100)|subtract(const_100,n0)|multiply(#0,const_100)|divide(#2,#1)|subtract(#3,const_100)|', 'category': 'gain'}, arguments=('Question: a shopkeeper sold an article offering a discount of 5 % and earned a profit of 31.1 % . what would have been the percentage of profit earned if no discount had been offered ?\nAnswer:', ' 30'), idx=2, metadata=('mathqa', 0, 1), resps=[], filtered_resps={}, task_name='mathqa', doc_id=0, repeats=1)
2025-05-22:19:44:27 INFO     [evaluator_utils:206] Task: ConfigurableTask(task_name=mathqa,output_type=multiple_choice,num_fewshot=0,num_samples=2985); document 0; context prompt (starting on next line):    
Question: a shopkeeper sold an article offering a discount of 5 % and earned a profit of 31.1 % . what would have been the percentage of profit earned if no discount had been offered ?
Answer:
(end of prompt on previous line)
target string or answer choice index (starting on next line):
0
(end of target on previous line)
2025-05-22:19:44:27 INFO     [evaluator_utils:210] Request: Instance(request_type='loglikelihood', doc={'Problem': 'a shopkeeper sold an article offering a discount of 5 % and earned a profit of 31.1 % . what would have been the percentage of profit earned if no discount had been offered ?', 'Rationale': '"giving no discount to customer implies selling the product on printed price . suppose the cost price of the article is 100 . then printed price = 100 ã — ( 100 + 31.1 ) / ( 100 â ˆ ’ 5 ) = 138 hence , required % profit = 138 â € “ 100 = 38 % answer a"', 'options': 'a ) 38 , b ) 27.675 , c ) 30 , d ) data inadequate , e ) none of these', 'correct': 'a', 'annotated_formula': 'subtract(divide(multiply(add(const_100, 31.1), const_100), subtract(const_100, 5)), const_100)', 'linear_formula': 'add(n1,const_100)|subtract(const_100,n0)|multiply(#0,const_100)|divide(#2,#1)|subtract(#3,const_100)|', 'category': 'gain'}, arguments=('Question: a shopkeeper sold an article offering a discount of 5 % and earned a profit of 31.1 % . what would have been the percentage of profit earned if no discount had been offered ?\nAnswer:', ' data inadequate'), idx=3, metadata=('mathqa', 0, 1), resps=[], filtered_resps={}, task_name='mathqa', doc_id=0, repeats=1)
2025-05-22:19:44:27 INFO     [evaluator_utils:206] Task: ConfigurableTask(task_name=mathqa,output_type=multiple_choice,num_fewshot=0,num_samples=2985); document 0; context prompt (starting on next line):    
Question: a shopkeeper sold an article offering a discount of 5 % and earned a profit of 31.1 % . what would have been the percentage of profit earned if no discount had been offered ?
Answer:
(end of prompt on previous line)
target string or answer choice index (starting on next line):
0
(end of target on previous line)
2025-05-22:19:44:27 INFO     [evaluator_utils:210] Request: Instance(request_type='loglikelihood', doc={'Problem': 'a shopkeeper sold an article offering a discount of 5 % and earned a profit of 31.1 % . what would have been the percentage of profit earned if no discount had been offered ?', 'Rationale': '"giving no discount to customer implies selling the product on printed price . suppose the cost price of the article is 100 . then printed price = 100 ã — ( 100 + 31.1 ) / ( 100 â ˆ ’ 5 ) = 138 hence , required % profit = 138 â € “ 100 = 38 % answer a"', 'options': 'a ) 38 , b ) 27.675 , c ) 30 , d ) data inadequate , e ) none of these', 'correct': 'a', 'annotated_formula': 'subtract(divide(multiply(add(const_100, 31.1), const_100), subtract(const_100, 5)), const_100)', 'linear_formula': 'add(n1,const_100)|subtract(const_100,n0)|multiply(#0,const_100)|divide(#2,#1)|subtract(#3,const_100)|', 'category': 'gain'}, arguments=('Question: a shopkeeper sold an article offering a discount of 5 % and earned a profit of 31.1 % . what would have been the percentage of profit earned if no discount had been offered ?\nAnswer:', ' none of these'), idx=4, metadata=('mathqa', 0, 1), resps=[], filtered_resps={}, task_name='mathqa', doc_id=0, repeats=1)
2025-05-22:19:44:27 INFO     [evaluator:559] Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/14925 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/14925 [00:05<24:15:52,  5.85s/it]Running loglikelihood requests:   1%|          | 89/14925 [00:06<12:06, 20.43it/s]  Running loglikelihood requests:   1%|▏         | 189/14925 [00:06<04:57, 49.58it/s]Running loglikelihood requests:   2%|▏         | 276/14925 [00:06<03:02, 80.05it/s]Running loglikelihood requests:   2%|▏         | 359/14925 [00:06<02:07, 113.94it/s]Running loglikelihood requests:   3%|▎         | 465/14925 [00:06<01:26, 166.52it/s]Running loglikelihood requests:   4%|▍         | 584/14925 [00:07<01:01, 232.18it/s]Running loglikelihood requests:   4%|▍         | 669/14925 [00:07<00:52, 269.11it/s]Running loglikelihood requests:   5%|▌         | 762/14925 [00:07<00:45, 312.76it/s]Running loglikelihood requests:   6%|▌         | 878/14925 [00:07<00:36, 382.22it/s]Running loglikelihood requests:   7%|▋         | 996/14925 [00:07<00:31, 444.83it/s]Running loglikelihood requests:   8%|▊         | 1140/14925 [00:08<00:25, 531.65it/s]Running loglikelihood requests:   8%|▊         | 1261/14925 [00:08<00:23, 572.24it/s]Running loglikelihood requests:   9%|▉         | 1374/14925 [00:08<00:22, 595.66it/s]Running loglikelihood requests:  10%|▉         | 1479/14925 [00:08<00:22, 602.11it/s]Running loglikelihood requests:  11%|█         | 1575/14925 [00:08<00:22, 595.35it/s]Running loglikelihood requests:  11%|█▏        | 1713/14925 [00:08<00:20, 654.93it/s]Running loglikelihood requests:  12%|█▏        | 1814/14925 [00:09<00:20, 645.69it/s]Running loglikelihood requests:  13%|█▎        | 1935/14925 [00:09<00:19, 670.95it/s]Running loglikelihood requests:  14%|█▎        | 2034/14925 [00:09<00:19, 658.12it/s]Running loglikelihood requests:  14%|█▍        | 2143/14925 [00:09<00:19, 667.76it/s]Running loglikelihood requests:  15%|█▍        | 2238/14925 [00:09<00:19, 649.53it/s]Running loglikelihood requests:  16%|█▌        | 2332/14925 [00:09<00:19, 635.37it/s]Running loglikelihood requests:  16%|█▋        | 2434/14925 [00:10<00:19, 643.30it/s]Running loglikelihood requests:  17%|█▋        | 2533/14925 [00:10<00:19, 645.58it/s]Running loglikelihood requests:  18%|█▊        | 2652/14925 [00:10<00:17, 684.52it/s]Running loglikelihood requests:  18%|█▊        | 2747/14925 [00:10<00:18, 671.91it/s]Running loglikelihood requests:  19%|█▉        | 2833/14925 [00:10<00:18, 644.80it/s]Running loglikelihood requests:  20%|█▉        | 2944/14925 [00:10<00:17, 673.05it/s]Running loglikelihood requests:  21%|██        | 3081/14925 [00:10<00:15, 741.15it/s]Running loglikelihood requests:  21%|██        | 3163/14925 [00:11<00:16, 705.35it/s]Running loglikelihood requests:  22%|██▏       | 3276/14925 [00:11<00:15, 736.19it/s]Running loglikelihood requests:  23%|██▎       | 3366/14925 [00:11<00:16, 717.14it/s]Running loglikelihood requests:  23%|██▎       | 3481/14925 [00:11<00:15, 754.49it/s]Running loglikelihood requests:  24%|██▍       | 3580/14925 [00:11<00:15, 748.05it/s]Running loglikelihood requests:  25%|██▍       | 3691/14925 [00:11<00:14, 769.33it/s]Running loglikelihood requests:  25%|██▌       | 3793/14925 [00:11<00:14, 767.09it/s]Running loglikelihood requests:  26%|██▌       | 3877/14925 [00:12<00:15, 731.95it/s]Running loglikelihood requests:  27%|██▋       | 3980/14925 [00:12<00:14, 750.55it/s]Running loglikelihood requests:  27%|██▋       | 4092/14925 [00:12<00:13, 781.76it/s]Running loglikelihood requests:  28%|██▊       | 4174/14925 [00:12<00:14, 740.24it/s]Running loglikelihood requests:  29%|██▊       | 4284/14925 [00:12<00:13, 771.13it/s]Running loglikelihood requests:  29%|██▉       | 4383/14925 [00:12<00:13, 769.84it/s]Running loglikelihood requests:  30%|██▉       | 4475/14925 [00:12<00:13, 761.05it/s]Running loglikelihood requests:  31%|███       | 4597/14925 [00:12<00:12, 820.41it/s]Running loglikelihood requests:  31%|███▏      | 4688/14925 [00:13<00:12, 798.03it/s]Running loglikelihood requests:  32%|███▏      | 4782/14925 [00:13<00:13, 759.37it/s]Running loglikelihood requests:  33%|███▎      | 4874/14925 [00:13<00:13, 760.25it/s]Running loglikelihood requests:  33%|███▎      | 4970/14925 [00:13<00:12, 769.57it/s]Running loglikelihood requests:  34%|███▍      | 5084/14925 [00:13<00:12, 814.75it/s]Running loglikelihood requests:  35%|███▍      | 5179/14925 [00:13<00:12, 806.63it/s]Running loglikelihood requests:  35%|███▌      | 5290/14925 [00:13<00:11, 836.51it/s]Running loglikelihood requests:  36%|███▌      | 5374/14925 [00:13<00:11, 796.17it/s]Running loglikelihood requests:  37%|███▋      | 5458/14925 [00:14<00:12, 766.79it/s]Running loglikelihood requests:  37%|███▋      | 5560/14925 [00:14<00:11, 794.84it/s]Running loglikelihood requests:  38%|███▊      | 5655/14925 [00:14<00:11, 798.43it/s]Running loglikelihood requests:  39%|███▊      | 5765/14925 [00:14<00:10, 835.75it/s]Running loglikelihood requests:  39%|███▉      | 5886/14925 [00:14<00:10, 888.43it/s]Running loglikelihood requests:  40%|████      | 5999/14925 [00:14<00:09, 905.17it/s]Running loglikelihood requests:  41%|████      | 6096/14925 [00:14<00:09, 886.25it/s]Running loglikelihood requests:  42%|████▏     | 6199/14925 [00:14<00:09, 887.26it/s]Running loglikelihood requests:  42%|████▏     | 6299/14925 [00:14<00:09, 885.04it/s]Running loglikelihood requests:  43%|████▎     | 6388/14925 [00:15<00:09, 855.80it/s]Running loglikelihood requests:  43%|████▎     | 6474/14925 [00:15<00:10, 827.84it/s]Running loglikelihood requests:  44%|████▍     | 6598/14925 [00:15<00:09, 897.15it/s]Running loglikelihood requests:  45%|████▍     | 6702/14925 [00:15<00:09, 903.91it/s]Running loglikelihood requests:  46%|████▌     | 6834/14925 [00:15<00:08, 972.17it/s]Running loglikelihood requests:  46%|████▋     | 6932/14925 [00:15<00:08, 942.95it/s]Running loglikelihood requests:  47%|████▋     | 7027/14925 [00:15<00:08, 916.89it/s]Running loglikelihood requests:  48%|████▊     | 7119/14925 [00:15<00:08, 885.96it/s]Running loglikelihood requests:  48%|████▊     | 7221/14925 [00:15<00:08, 900.48it/s]Running loglikelihood requests:  49%|████▉     | 7322/14925 [00:16<00:08, 907.45it/s]Running loglikelihood requests:  50%|████▉     | 7445/14925 [00:16<00:07, 967.50it/s]Running loglikelihood requests:  51%|█████     | 7562/14925 [00:16<00:07, 992.26it/s]Running loglikelihood requests:  52%|█████▏    | 7688/14925 [00:16<00:06, 1034.30it/s]Running loglikelihood requests:  52%|█████▏    | 7793/14925 [00:16<00:07, 1015.15it/s]Running loglikelihood requests:  53%|█████▎    | 7895/14925 [00:16<00:07, 997.10it/s] Running loglikelihood requests:  54%|█████▎    | 7998/14925 [00:16<00:07, 986.09it/s]Running loglikelihood requests:  54%|█████▍    | 8116/14925 [00:16<00:06, 1015.81it/s]Running loglikelihood requests:  55%|█████▌    | 8218/14925 [00:16<00:06, 992.23it/s] Running loglikelihood requests:  56%|█████▌    | 8318/14925 [00:17<00:06, 976.92it/s]Running loglikelihood requests:  57%|█████▋    | 8473/14925 [00:17<00:05, 1104.40it/s]Running loglikelihood requests:  58%|█████▊    | 8584/14925 [00:17<00:05, 1081.57it/s]Running loglikelihood requests:  58%|█████▊    | 8726/14925 [00:17<00:05, 1176.96it/s]Running loglikelihood requests:  59%|█████▉    | 8866/14925 [00:17<00:04, 1241.08it/s]Running loglikelihood requests:  60%|██████    | 8991/14925 [00:17<00:05, 1006.34it/s]Running loglikelihood requests:  61%|██████    | 9140/14925 [00:17<00:05, 1127.99it/s]Running loglikelihood requests:  62%|██████▏   | 9300/14925 [00:17<00:04, 1252.65it/s]Running loglikelihood requests:  63%|██████▎   | 9458/14925 [00:17<00:04, 1342.26it/s]Running loglikelihood requests:  64%|██████▍   | 9609/14925 [00:18<00:04, 1138.79it/s]Running loglikelihood requests:  65%|██████▌   | 9774/14925 [00:18<00:04, 1265.50it/s]Running loglikelihood requests:  67%|██████▋   | 9945/14925 [00:18<00:03, 1381.58it/s]Running loglikelihood requests:  68%|██████▊   | 10092/14925 [00:18<00:04, 1162.94it/s]Running loglikelihood requests:  69%|██████▉   | 10278/14925 [00:18<00:03, 1332.36it/s]Running loglikelihood requests:  70%|██████▉   | 10423/14925 [00:18<00:03, 1151.51it/s]Running loglikelihood requests:  71%|███████   | 10588/14925 [00:18<00:03, 1269.65it/s]Running loglikelihood requests:  72%|███████▏  | 10734/14925 [00:19<00:03, 1121.23it/s]Running loglikelihood requests:  73%|███████▎  | 10948/14925 [00:19<00:02, 1360.87it/s]Running loglikelihood requests:  74%|███████▍  | 11102/14925 [00:19<00:03, 1211.17it/s]Running loglikelihood requests:  76%|███████▌  | 11273/14925 [00:19<00:03, 1143.29it/s]Running loglikelihood requests:  77%|███████▋  | 11445/14925 [00:19<00:03, 1109.34it/s]Running loglikelihood requests:  78%|███████▊  | 11662/14925 [00:19<00:02, 1163.24it/s]Running loglikelihood requests:  80%|███████▉  | 11875/14925 [00:20<00:02, 1195.66it/s]Running loglikelihood requests:  81%|████████  | 12118/14925 [00:20<00:01, 1454.92it/s]Running loglikelihood requests:  82%|████████▏ | 12284/14925 [00:20<00:01, 1321.01it/s]Running loglikelihood requests:  84%|████████▍ | 12504/14925 [00:20<00:01, 1329.27it/s]Running loglikelihood requests:  85%|████████▌ | 12712/14925 [00:20<00:01, 1332.91it/s]Running loglikelihood requests:  87%|████████▋ | 12935/14925 [00:20<00:01, 1361.38it/s]Running loglikelihood requests:  89%|████████▊ | 13225/14925 [00:20<00:01, 1505.64it/s]Running loglikelihood requests:  90%|█████████ | 13501/14925 [00:21<00:00, 1599.57it/s]Running loglikelihood requests:  93%|█████████▎| 13820/14925 [00:21<00:00, 1767.47it/s]Running loglikelihood requests:  94%|█████████▍| 14096/14925 [00:21<00:00, 1829.47it/s]Running loglikelihood requests:  96%|█████████▌| 14334/14925 [00:21<00:00, 1855.69it/s]Running loglikelihood requests:  98%|█████████▊| 14582/14925 [00:21<00:00, 1912.19it/s]Running loglikelihood requests: 100%|█████████▉| 14854/14925 [00:22<00:00, 653.60it/s] Running loglikelihood requests: 100%|██████████| 14925/14925 [00:22<00:00, 659.69it/s]
fatal: not a git repository (or any parent up to mount point /mnt)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).
2025-05-22:19:45:04 INFO     [loggers.evaluation_tracker:209] Saving results aggregated
2025-05-22:19:45:04 INFO     [loggers.evaluation_tracker:298] Saving per-sample results for: mathqa
Passed argument batch_size = auto:1. Detecting largest batch size
Determined largest batch size: 64
hf (pretrained=meta-llama/Llama-3.2-1B-Instruct), gen_kwargs: (None), limit: None, num_fewshot: None, batch_size: auto (64)
|Tasks |Version|Filter|n-shot| Metric |   |Value |   |Stderr|
|------|------:|------|-----:|--------|---|-----:|---|-----:|
|mathqa|      1|none  |     0|acc     |↑  |0.3307|±  |0.0086|
|      |       |none  |     0|acc_norm|↑  |0.3266|±  |0.0086|

